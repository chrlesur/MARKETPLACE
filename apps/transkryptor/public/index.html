<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transkryptor - Marketplace</title>
    
    <!-- Polices Google -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono&display=swap" rel="stylesheet">
    
    <!-- Bibliothèques externes -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Styles partagés de la Marketplace -->
    <link rel="stylesheet" href="/shared/styles.css">
    
    <!-- Styles spécifiques à Transkryptor -->
    <link rel="stylesheet" href="css/marketplace-integration.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/columns.css">
    <link rel="stylesheet" href="css/forms.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/questions.css">
    <link rel="stylesheet" href="css/facts.css">
    <link rel="stylesheet" href="css/progress.css">
    <!-- Styles d'override pour la marketplace -->
    <link rel="stylesheet" href="css/marketplace-overrides.css"></head>

<body>
    <!-- Conteneur pour la barre de navigation -->
    <div id="navbar-container"></div>
    
    <div class="app-container">

    <div class="main-container">
        <div class="column">
            <div class="block">
                <h2>Configuration</h2>
                <form id="apiKeysForm">
                    <div>
                        <label for="openaiKey">Clé API OpenAI:</label>
                        <input type="password" id="openaiKey" required>
                    </div>
                    <div>
                        <label for="anthropicKey">Clé API Anthropic:</label>
                        <input type="password" id="anthropicKey" required>
                    </div>
                    <div class="button-group">
                        <button type="button" onclick="testAPIKeys()">Tester les clés API</button>
                        <button type="button" onclick="clearAPIKeys()">Effacer les clés</button>
                    </div>
                </form>
            </div>
            <div class="block">
                <h2>Fichier source</h2>
                <div>
                    <label for="audioFile">Fichier audio (M4A):</label>
                    <input type="file" id="audioFile" accept=".m4a" required>
                    <div class="button-group">
                        <button onclick="processAudio()">Transcrire</button>
                        <button onclick="loadTranscription()">Charger une transcription</button>
                        <button onclick="loadAnalysis()">Charger une analyse</button>
                    </div>
                </div>
                <input type="file" id="transcriptionFile" accept=".txt" style="display:none;">
                <input type="file" id="analysisFile" accept=".txt" style="display:none;">
            </div>

            <div class="block">
                <h2>Progression globale</h2>
                <div class="progress-container">
                    <div id="globalProgress" class="progress-bar"></div>
                    <div id="globalProgressText" class="progress-text">0%</div>
                </div>
            </div>

            <div class="block">
                <h2>Progression par lot</h2>
                <div id="batchProgress"></div>
            </div>

            <div class="block">
                <h2>Journaux</h2>
                <div id="debug"></div>
            </div>
        </div>

        <div class="column">
            <div class="block">
                <h2>
                    <span>Transcription brute</span>
                    <button onclick="downloadTranscription()">Télécharger la transcription</button>
                </h2>
                <div id="rawTranscription"></div>
            </div>

            <div class="block">
                <h2>
                    <span>Analyse</span>
                    <button onclick="window.analyzeTranscription()">Analyser la transcription</button>
                    <button id="downloadAnalysisButton" onclick="downloadAnalysis()" style="display: none;">Télécharger l'analyse</button>
                </h2>
                <div id="analyzeResult"></div>
            </div>

            <div class="block">
                <h2>
                    <span>Synthèse</span>
                    <button id="synthesizeButton" onclick="window.synthesizeAnalysis()" style="display: none;">Synthétiser l'analyse</button>
                    <button id="downloadSynthesisButton" onclick="downloadSynthesis()" style="display: none;">Télécharger la synthèse</button>
                </h2>
                <div id="synthesisResult"></div>
            </div>
        </div>
    </div>

    <script src="js/state.js" type="module"></script>
    <script src="js/config.js" type="module"></script>
    <script src="js/utils/utils.js" type="module"></script>
    <script src="js/utils/downloadHandlers.js" type="module"></script>
    <script src="js/audio.js" type="module"></script>
    <script src="js/utils/factExtractor.js" type="module"></script>
    <script src="js/synthesizer.js" type="module"></script>
    <script src="js/analysis.js" type="module"></script>
    <script src="js/fileHandlers.js" type="module"></script>
    <script src="js/ui.js" type="module"></script>
    <script src="js/main.js" type="module"></script>
    
    <!-- Module d'intégration avec la Marketplace -->
    <script src="js/marketplace-integration.js" type="module"></script>
    <!-- Script d'override pour la marketplace -->
    <script src="js/marketplace-overrides.js"></script></body>

</html>
